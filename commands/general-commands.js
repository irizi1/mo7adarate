// commands/general-commands.js

const { SIGNATURE } = require('../config');
const state = require('../state');

/**
 * @description ูุนุฑุถ ูุงุฆูุฉ ุงูุฃูุงูุฑ ุงููุชุงุญุฉ.
 * @param {Message} message - ูุงุฆู ุงูุฑุณุงูุฉ.
 * @param {Client} client - ุนููู ูุงุชุณุงุจ.
 */
async function handleCommandsCommand(message, client) {
    const commandsList = `
๐ *ูุงุฆูุฉ ุงูุฃูุงูุฑ ุงููุชุงุญุฉ:*

๐ง *ุฃูุงูุฑ ุงููุดุฑููู:*
โข !ุฅุนุฏุงุฏ - ูุฅุนุฏุงุฏ ุงููุธุงู (ูููุดุฑููู ููุท)
โข !ุงุถุงูุฉ_ูุญุงุถุฑุฉ - ูุฅุถุงูุฉ ูุญุงุถุฑุฉ ุฌุฏูุฏุฉ (ูููุดุฑููู ููุท)
โข !ุนุฑุถ_ุงููุญุงุถุฑุงุช - ูุนุฑุถ ูุชุญููู ุงููุญุงุถุฑุงุช
โข !ุฅุฏุงุฑุฉ_ุงูููุฑุฑุงุช - ูุฅุฏุงุฑุฉ ุงูููุฑุฑุงุช ุงูุฏุฑุงุณูุฉ (ูููุดุฑููู ููุท)
โข !ุงุถุงูุฉ_ูุทูุฑ - ูุฅุถุงูุฉ ูุทูุฑ ุฌุฏูุฏ (ูููุงูู ููุท)
โข !ุงุญุตุงุฆูุงุช - ูุนุฑุถ ุฅุญุตุงุฆูุงุช ุงูุจูุช (ูููุงูู ููุท)
โข !ุงุนุงุฏุฉ_ุชุดุบูู - ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุจูุช (ูููุงูู ููุท)

๐ *ุฃูุงูุฑ ุงููุญุงุถุฑุงุช:*
โข !ุจุญุซ - ููุจุญุซ ุนู ูุญุงุถุฑุฉ
โข !ุชุญููู - ูุชุญููู ูุญุงุถุฑุฉ ูุญุฏุฏุฉ

๐ค *ุฃูุงูุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู:*
โข !ุณุคุงู - ูุทุฑุญ ุณุคุงู ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
โข !ุชุฑุฌูุฉ - ูุชุฑุฌูุฉ ูุต
โข !ุชูุฎูุต - ูุชูุฎูุต ูุต

๐ *ุฃูุงูุฑ ุฃุฎุฑู:*
โข !ุงุณุชุทูุงุน - ูุฅูุดุงุก ุงุณุชุทูุงุน ุฑุฃู
โข !ูุณุงุนุฏุฉ - ูุนุฑุถ ุงููุณุงุนุฏุฉ
โข !ุฅุจูุงุบ - ููุฅุจูุงุบ ุนู ูุดููุฉ

๐ก ูุฅุฑุณุงู ููุงุญุธุงุช ุฃู ุงูุชุฑุงุญุงุชุ ุงุณุชุฎุฏู ุฃูุฑ !ุฅุจูุงุบ${SIGNATURE}
    `;
    
    await message.reply(commandsList);
}

/**
 * @description ูุนุฑุถ ูุนูููุงุช ุงููุณุงุนุฏุฉ.
 * @param {Message} message - ูุงุฆู ุงูุฑุณุงูุฉ.
 * @param {Client} client - ุนููู ูุงุชุณุงุจ.
 */
async function handleHelpCommand(message, client) {
    const helpText = `
๐ค *ูุณุงุนุฏุฉ ุจูุช ูุงุชุณุงุจ*

ูุฑุญุจุงู ุจู ูู ุจูุช ูุงุชุณุงุจ ูุฅุฏุงุฑุฉ ุงููุญุงุถุฑุงุช ูุงูููุฑุฑุงุช ุงูุฏุฑุงุณูุฉ!

*ููููุฉ ุงุณุชุฎุฏุงู ุงูุจูุช:*

1. *ูููุดุฑููู:*
   - ุงุณุชุฎุฏู ุฃูุฑ !ุฅุนุฏุงุฏ ูุฅุนุฏุงุฏ ุงููุธุงู ูููุฑุฉ ุงูุฃููู.
   - ุงุณุชุฎุฏู ุฃูุฑ !ุงุถุงูุฉ_ูุญุงุถุฑุฉ ูุฅุถุงูุฉ ูุญุงุถุฑุงุช ุฌุฏูุฏุฉ.
   - ุงุณุชุฎุฏู ุฃูุฑ !ุฅุฏุงุฑุฉ_ุงูููุฑุฑุงุช ูุฅุฏุงุฑุฉ ุงูุดุนุจ ูุงููุตูู ูุงูููุงุฏ.

2. *ููุทูุงุจ:*
   - ุงุณุชุฎุฏู ุฃูุฑ !ุนุฑุถ_ุงููุญุงุถุฑุงุช ูุนุฑุถ ุงููุญุงุถุฑุงุช ุงููุชุงุญุฉ.
   - ุงุณุชุฎุฏู ุฃูุฑ !ุชุญููู ูุชุญููู ูุญุงุถุฑุฉ ูุญุฏุฏุฉ.
   - ุงุณุชุฎุฏู ุฃูุฑ !ุจุญุซ ููุจุญุซ ุนู ูุญุงุถุฑุฉ.

3. *ููุฌููุน:*
   - ุงุณุชุฎุฏู ุฃูุฑ !ุณุคุงู ูุทุฑุญ ุณุคุงู ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู.
   - ุงุณุชุฎุฏู ุฃูุฑ !ุชุฑุฌูุฉ ูุชุฑุฌูุฉ ูุต.
   - ุงุณุชุฎุฏู ุฃูุฑ !ุชูุฎูุต ูุชูุฎูุต ูุต.

*ููุงุญุธุงุช:*
- ุจุนุถ ุงูุฃูุงูุฑ ุชุชุทูุจ ุตูุงุญูุงุช ูุดุฑู.
- ููููู ุฅูุบุงุก ุฃู ุนูููุฉ ุนู ุทุฑูู ูุชุงุจุฉ "ุฅูุบุงุก".
- ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉุ ุงุณุชุฎุฏู ุฃูุฑ !ุฅุจูุงุบ ููุฅุจูุงุบ ุนููุง.${SIGNATURE}
    `;
    
    await message.reply(helpText);
}

/**
 * @description ูุณูุญ ูููุณุชุฎุฏููู ุจุงูุฅุจูุงุบ ุนู ูุดุงูู.
 * @param {Message} message - ูุงุฆู ุงูุฑุณุงูุฉ.
 * @param {Client} client - ุนููู ูุงุชุณุงุจ.
 */
async function handleReportCommand(message, client) {
    const reportText = message.body.replace(/^!ุฅุจูุงุบ|^!report/i, '').trim();
    
    if (!reportText) {
        await message.reply(`โ๏ธ ูุฑุฌู ูุชุงุจุฉ ุงููุดููุฉ ุงูุชู ุชุฑูุฏ ุงูุฅุจูุงุบ ุนููุง. ูุซุงู: !ุฅุจูุงุบ ูุง ูููููู ุชุญููู ุงููุญุงุถุฑุงุช${SIGNATURE}`);
        return;
    }
    
    await message.react('๐');
    
    try {
        const contact = await message.getContact();
        const userName = contact.pushname || contact.name || "ูุณุชุฎุฏู";
        const userId = contact.id._serialized;
        
        const reportMessage = `
๐ฉ *ุชูุฑูุฑ ุฌุฏูุฏ*

*ุงููุณุชุฎุฏู:* ${userName} (${userId})
*ุงููุดููุฉ:* ${reportText}
*ุงูุชุงุฑูุฎ ูุงูููุช:* ${new Date().toLocaleString('ar-SA')}
        `;
        
        // ุฅุฑุณุงู ุงูุชูุฑูุฑ ุฅูู ุงููุงูู
        if (state.OWNER_ID) {
            await client.sendMessage(state.OWNER_ID, reportMessage);
        }
        
        await message.reply(`โ ุชู ุฅุฑุณุงู ุชูุฑูุฑู ุจูุฌุงุญ. ุดูุฑุงู ูู ุนูู ูุณุงุนุฏุชูุง ูู ุชุญุณูู ุงูุจูุช!${SIGNATURE}`);
    } catch (error) {
        console.error('[โ] Error in report command:', error);
        await message.reply(`โ๏ธ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุชูุฑูุฑู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ูุงุญููุง.${SIGNATURE}`);
    }
}

module.exports = {
    '!ุฃูุงูุฑ': handleCommandsCommand,
    '!commands': handleCommandsCommand,
    '!ูุณุงุนุฏุฉ': handleHelpCommand,
    '!help': handleHelpCommand,
    '!ุฅุจูุงุบ': handleReportCommand,
    '!report': handleReportCommand,
};